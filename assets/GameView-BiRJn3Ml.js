import{_ as x,u as P,c as S,a as u,o as i,b as s,t as c,F as q,r as B,n as O,d as M,s as R,w as N,e as v,f as C,g as E,h as e,i as Y,j as J,k as K,S as X,l as Q,m as G}from"./index-DRgojYaf.js";const Z={class:"square-id-container"},ee={class:"square-id"},se={class:"icons-container"},te={class:"text-container"},ae={class:"effect-text"},oe={__name:"BoardSquare",props:{square:{type:Object,required:!0}},setup(y){const t=y,l=P(),d=S(()=>l.highlightedTargetSquare===t.square.id),_=S(()=>l.playerPosition===t.square.id),r=S(()=>{var g,k,b;const a=t.square;let o=[],n="";if(a.baseType==="start"?o.push("🏁"):a.baseType==="corner_br"?(o.push("☣️"),n="-$20"):a.baseType.startsWith("corner_")&&o.push("⭐"),a.isTempBad)o=["💀"],n=`Trap! (-$${((g=a.effectDetails)==null?void 0:g.penalty)||"?"})`;else switch(a.currentEffectType){case"huge_money":o=["💰"],n=`+$${((k=a.effectDetails)==null?void 0:k.amount)||l.currentHugeMoneyValue}`;break;case"choice_dice_money":o=["💰","🎲"],n="Choice!";break;case"choice_pick_die":o=["🎲"],n="Get Die!";break;case"normal_money":a.baseType.startsWith("corner_")||o.push("🪙"),n=`+$${((b=a.effectDetails)==null?void 0:b.amount)||"?"}`;break;case"none":a.baseType==="normal"&&o.length===0&&(n="");break}return o.length===0&&a.baseType==="normal"&&a.currentEffectType==="none"&&o.push("▫️"),{icons:o,text:n}}),p=S(()=>({"player-is-on-this-square":_.value,"temp-bad":t.square.isTempBad,corner:t.square.baseType.startsWith("corner_"),"corner-br":t.square.baseType==="corner_br","start-square":t.square.baseType==="start","effect-huge-money":t.square.currentEffectType==="huge_money","effect-choice":t.square.currentEffectType==="choice_dice_money"||t.square.currentEffectType==="choice_pick_die","effect-normal-money":t.square.currentEffectType==="normal_money"}));return(a,o)=>(i(),u("div",{class:O(["board-square",[y.square.baseType,y.square.currentEffectType,p.value,{highlighted:d.value,active:_.value}]])},[s("div",Z,[s("span",ee,c(y.square.id),1)]),s("div",se,[(i(!0),u(q,null,B(r.value.icons,(n,g)=>(i(),u("span",{key:g,class:"icon-display"},c(n),1))),128))]),s("div",te,[s("span",ae,c(r.value.text),1)])],2))}},ne=x(oe,[["__scopeId","data-v-45be187a"]]),ie={class:"game-board-wrapper"},re=["src"],le={key:0,class:"general-die-result"},ce={key:1,class:"boss-overlay-inside-board"},de={class:"boss-wrapper animated-boss"},ue={class:"boss-name"},_e=["src"],me={key:1,class:"boss-die-result"},pe={class:"boss-counters"},ge={__name:"GameBoard",setup(y){const t=M(!1),l=P(),{boardSquares:d,boardRows:_,boardCols:r,playerPosition:p,currentBoss:a,currentBossHP:o,currentBossMaxHP:n}=R(l);N(o,(f,$)=>{$!=null&&f<$&&(console.log("daño!"),t.value=!0,setTimeout(()=>{t.value=!1},300))});const g={width:40,height:40},k=new URL("/assets/images/sprites/knight_static.png",import.meta.url).href;function b(f,$,D){const m=$,h=D;return m<=1||h<=1?m===1?{r:1,c:f+1}:h===1?{r:f+1,c:1}:{r:1,c:1}:f>=0&&f<m?{r:f+1,c:1}:f>=m&&f<m+h-1?{r:m,c:f-m+2}:f>=m+h-1&&f<m+h-1+m-1?{r:m-1-(f-(m+h-1)),c:h}:f>=m+h-1+m-1&&f<l.totalBoardSquares?{r:1,c:h-1-(f-(m+h-1+m-1))}:(console.warn("GameBoard: Could not determine grid position for squareId:",f,"R:",m,"C:",h),{r:1,c:1})}function T(f,$,D){const m=b(f,$,D);return{gridRowStart:m.r,gridColumnStart:m.c}}const w=S(()=>{if(!d.value||d.value.length===0||_.value===0||r.value===0)return{display:"none"};const f=p.value,$=_.value,D=r.value,m=b(f,$,D),h=60,L=g.width,j=g.height,A=(m.r-1)*h,V=(m.c-1)*h,F=(h-j)/2,H=(h-L)/2,z=A+F,W=V+H;return{position:"absolute",top:`${z}px`,left:`${W}px`,width:`${L}px`,height:`${j}px`,zIndex:10,pointerEvents:"none"}}),I=S(()=>a.value&&a.value.image?`/assets/images/bosses/${a.value.image}`:"");return(f,$)=>{var D,m;return i(),u("div",ie,[s("div",{class:"game-board-perimeter",style:E({gridTemplateColumns:`repeat(${e(r)}, 60px)`,gridTemplateRows:`repeat(${e(_)}, 60px)`,width:`${e(r)*60}px`,height:`${e(_)*60}px`})},[(i(!0),u(q,null,B(e(d),h=>(i(),C(ne,{key:h.id,square:h,style:E(T(h.id,e(_),e(r)))},null,8,["square","style"]))),128)),e(d).length>0?(i(),u("img",{key:0,src:e(k),alt:"Player",class:"static-player-marker",style:E(w.value)},null,12,re)):v("",!0)],4),e(l).showGeneralRollAnimation?(i(),u("div",le," 🎲 "+c(e(l).lastGeneralRoll),1)):v("",!0),e(l).gamePhase==="boss_encounter"?(i(),u("div",ce,[s("div",de,[s("h2",ue,c((D=e(l).currentBoss)==null?void 0:D.name),1),I.value?(i(),u("img",{key:0,src:I.value,alt:"Boss",class:"boss-image"},null,8,_e)):v("",!0),s("p",{class:O(["boss-hp-text",{"hp-damaged":t.value}])}," ❤️ Vida del jefe: "+c(e(o))+" / "+c(e(n)),3),s("button",{class:"pay-boss-button",onClick:$[0]||($[0]=(...h)=>e(l).payToDefeatBoss&&e(l).payToDefeatBoss(...h))}," 💰 Pagar "+c(((m=e(l).currentBoss)==null?void 0:m.bribeCost)||"??")+" monedas para derrotar al jefe ",1),e(l).bossLastRoll!==null?(i(),u("div",me," 🎲 "+c(e(l).bossLastRoll),1)):v("",!0),s("div",pe,[s("p",null,[$[1]||($[1]=s("strong",null,"🎲 Dados restantes:",-1)),Y(" "+c(e(l).remainingBossRolls),1)])])])])):v("",!0)])}}},fe=x(ge,[["__scopeId","data-v-3d941913"]]),he={class:"game-stats-panel"},ye={class:"debug-info"},ve={key:0},be={key:1,class:"game-feedback"},$e={key:2},ke={__name:"GameInfo",setup(y){const t=P(),{playerPosition:l,playerMoney:d,playerLap:_,playerStage:r,currentStageConfig:p,lastDiceRoll:a,gameMessage:o}=R(t);return(n,g)=>{var k;return i(),u("div",he,[s("h3",null," Etapa: "+c(e(r))+" | Vuelta: "+c(e(_))+" / "+c(((k=e(p))==null?void 0:k.lapsToComplete)||3),1),s("p",null,"⬇️Posición: "+c(e(l)),1),s("p",null,"🪙Dinero: $"+c(e(d)),1),g[0]||(g[0]=s("hr",null,null,-1)),s("div",ye,[e(a)?(i(),u("p",ve," Última tirada: "+c(e(a).value)+" ("+c(e(a).type)+" die, "+c(e(a).direction)+") ",1)):v("",!0),e(o)?(i(),u("p",be,c(e(o)),1)):v("",!0),!e(a)&&!e(o)?(i(),u("p",$e,"Tira el dado!")):v("",!0)])])}}},De=x(ke,[["__scopeId","data-v-daf094c6"]]),xe={class:"single-die-display"},Se=["disabled"],Te=["src","alt"],Pe={key:1,class:"fallback-text"},Ce={class:"die-label"},qe={key:1,class:"last-roll-display"},Be=["src","alt"],Re={key:1,class:"fallback-text"},we={class:"die-label"},Ee={__name:"SingleDieDisplay",props:{die:{type:Object,required:!0},isLastRoll:{type:Boolean,default:!1}},emits:["use-die"],setup(y,{emit:t}){const l=y,d=t,_=M(null),r=M(!1);function p(){r.value=!1;const n=J(l.die,l.isLastRoll);n?_.value=K(n):(_.value=null,r.value=!0)}N(()=>l.die,p,{immediate:!0,deep:!0});function a(n){r.value=!0,n.target&&(n.target.style.display="none")}function o(n){let g=n.type||"";return n.value!==void 0&&(g+=` (${n.value})`),l.isLastRoll&&n.direction&&(g+=` ${n.direction}`),g}return(n,g)=>(i(),u("div",xe,[y.isLastRoll?(i(),u("div",qe,[_.value&&!r.value?(i(),u("img",{key:0,src:_.value,alt:o(y.die),onError:a},null,40,Be)):v("",!0),r.value||!_.value?(i(),u("span",Re,"[img]")):v("",!0),s("span",we,c(o(y.die)),1)])):(i(),u("button",{key:0,onClick:g[0]||(g[0]=k=>d("use-die")),disabled:y.die.used,class:"die-button"},[_.value&&!r.value?(i(),u("img",{key:0,src:_.value,alt:o(y.die),onError:a},null,40,Te)):v("",!0),r.value||!_.value?(i(),u("span",Pe,"[img]")):v("",!0),s("span",Ce,c(o(y.die)),1)],8,Se))]))}},U=x(Ee,[["__scopeId","data-v-ad0dcf8b"]]),Ge={class:"reserved-dice-container"},Me={key:0,class:"no-dice-text"},Ie={class:"dice-grid"},Le={__name:"ReservedDiceDisplay",setup(y){const t=P(),{reservedDice:l,diceBagCapacityDisplay:d}=R(t);function _(r){const p=t.reservedDice[r];t.isGameOver||!p||(t.gamePhase==="boss_encounter"?t.rollDiceForBoss(p):t.gamePhase==="rolling"&&t.rollDice(r))}return(r,p)=>(i(),u("div",Ge,[s("h3",null,"Dados en la bolsa ("+c(e(d))+")",1),e(l).length===0?(i(),u("p",Me,"None")):v("",!0),s("div",Ie,[(i(!0),u(q,null,B(e(l),(a,o)=>(i(),C(U,{key:`${a.type}-${a.value??0}-${o}`,die:a,onMouseenter:n=>e(t).highlightSquareForDie(a),onMouseleave:e(t).clearHighlightedSquare,onUseDie:n=>_(o)},null,8,["die","onMouseenter","onMouseleave","onUseDie"]))),128))])]))}},je=x(Le,[["__scopeId","data-v-a556a64f"]]),Oe={class:"modal-overlay"},Ne={class:"modal-content"},Ue={class:"options-container"},Ae=["onClick"],Ve={class:"option-visuals"},Fe={key:0,class:"emoji-icon"},He={class:"option-text"},ze={__name:"ChoiceModal",props:{details:{type:Object,required:!0}},emits:["player-choice"],setup(y,{emit:t}){const l=t;function d(_){l("player-choice",_)}return(_,r)=>(i(),u("div",Oe,[s("div",Ne,[s("h4",null,c(y.details.message),1),s("div",Ue,[(i(!0),u(q,null,B(y.details.options,(p,a)=>{var o,n;return i(),u("button",{key:a,onClick:g=>d(p),class:"choice-button"},[s("div",Ve,[((o=p.visual)==null?void 0:o.type)==="money"?(i(),u("span",Fe,"💰")):v("",!0),((n=p.visual)==null?void 0:n.type)==="die"&&p.visual.dieData?(i(),C(U,{key:1,die:p.visual.dieData,"is-last-roll":!1,class:"compact-die-in-choice"},null,8,["die"])):v("",!0)]),s("span",He,c(p.text),1)],8,Ae)}),128))])])]))}},We=x(ze,[["__scopeId","data-v-dd6ad4f2"]]),Ye={class:"modal-backdrop"},Je={class:"modal-content"},Ke={class:"summary-list"},Xe={class:"ending-message"},Qe={__name:"SummaryModal",setup(y){const t=P(),l=t.playerMoney,d=t.totalRolls,_=t.diceObtained,r=t.bossesDefeated,p=t.perfectBossDefeats,a=t.bribesBosses,o=Object.keys(X).length;function n(){return a===o?"💰 Dejaste que el dinero te corrompiera... ¡El poder del soborno te consumió!":a>r?"🤝 Preferiste negociar antes que pelear... ¿Habrá sido lo correcto?":r>a?p>0?"⚔️ Un guerrero habilidoso que no teme enfrentar a sus enemigos.":"🗡️ Derrotaste a tus enemigos con valentía, aunque no siempre con precisión.":r===o?p===o?"👑 ¡LEYENDA! Derrotaste a todos los jefes con precisión perfecta. ¡Increíble!":"🏆 ¡Un verdadero campeón! Derrotaste a todos los jefes sin recurrir a sobornos.":"🎮 El viaje ha terminado... ¿Pero fue este el mejor camino?"}function g(){t.resetGame()}return(k,b)=>(i(),u("div",Ye,[s("div",Je,[b[0]||(b[0]=s("h2",null,"🏁 Resumen de la Partida",-1)),s("ul",Ke,[s("li",null,"💰 Dinero reunido: $"+c(e(l)),1),s("li",null,"🎲 Dados lanzados: "+c(e(d)),1),s("li",null,"🎁 Dados obtenidos: "+c(e(_)),1),s("li",null,"⚔️ Jefes derrotados: "+c(e(r)),1),s("li",null,"✨ Derrotas perfectas: "+c(e(p)),1),s("li",null,"💸 Jefes sobornados: "+c(e(a)),1)]),s("p",Xe,c(n()),1),s("button",{onClick:g},"Reiniciar Partida")])]))}},Ze=x(Qe,[["__scopeId","data-v-dc1f0820"]]),es={class:"game-view-container"},ss={class:"main-game-area"},ts={class:"left-panel-area"},as={class:"player-display-area"},os=["src"],ns={class:"game-board-container"},is={class:"right-action-panel"},rs={class:"action-buttons-group"},ls={class:"normal-roll-button-container"},cs=["disabled"],ds={class:"speed-control-container"},us={__name:"GameView",setup(y){const t=["/assets/images/dice/die_d6.png","/assets/images/dice/die_fixed_1.png","/assets/images/dice/die_fixed_2.png","/assets/images/dice/die_fixed_3.png","/assets/images/dice/die_fixed_4.png","/assets/images/dice/die_fixed_5.png","/assets/images/dice/die_fixed_6.png","/assets/images/dice/die_d20.png","/assets/images/dice/die_d6_reverse.png","/assets/images/dice/die_fixed_reverse_1.png","/assets/images/dice/die_fixed_reverse_2.png","/assets/images/dice/die_fixed_reverse_3.png","/assets/images/dice/die_fixed_reverse_4.png","/assets/images/dice/die_fixed_reverse_5.png","/assets/images/dice/die_fixed_reverse_6.png","/assets/images/bosses/dark_godcat.webp","/assets/images/bosses/dragon_treasurer.png","/assets/images/bosses/goblin_general.png","/assets/images/bosses/greedy_goblin_king.webp","/assets/images/bosses/orc_general.png","/assets/images/bosses/tax_collector.png"];function l(b){b.forEach(T=>{const w=new Image;w.src=T})}const d=P(),{isGameOver:_,gamePhase:r,choiceDetails:p}=R(d),a=new URL("/assets/images/sprites/knight_static.png",import.meta.url).href;Q(()=>{l(t),d.initializeGame()});function o(){(d.gamePhase==="rolling"||d.gamePhase==="boss_encounter")&&!d.isGameOver&&d.assetsLoaded&&d.rollDice()}function n(b){d.playerMakesChoice(b)}const g=S(()=>{switch(d.animationSpeedMultiplier){case 0:return"Instant";case 1:return"Normal";case 2:return"Faster";default:return"Unknown"}});function k(){d.toggleAnimationSpeed()}return(b,T)=>(i(),u("div",es,[s("div",ss,[s("div",ts,[s("div",as,[s("img",{src:e(a),alt:"Player Knight",class:"large-static-player-image"},null,8,os),T[0]||(T[0]=s("h3",{class:"player-name"},"The Knight",-1))]),G(De,{class:"game-info-content"})]),s("div",ns,[G(fe,{class:"game-board-component"})]),s("div",is,[G(je,{class:"dice-reserve-component"}),s("div",rs,[s("div",ls,[s("button",{onClick:o,disabled:e(_)||e(d).isAnimating||e(r)!=="boss_encounter"&&e(r)!=="rolling"||e(r)==="boss_encounter"&&e(d).remainingBossRolls<=0,class:"roll-button"}," Roll Normal Die ",8,cs)]),s("div",ds,[s("button",{onClick:k,class:"speed-button"}," Speed: "+c(g.value),1)])])])]),e(r)==="awaiting_choice"&&e(p)?(i(),C(We,{key:0,details:e(p),onPlayerChoice:n},null,8,["details"])):v("",!0),e(d).showSummaryModal?(i(),C(Ze,{key:1})):v("",!0)]))}},ms=x(us,[["__scopeId","data-v-9b712670"]]);export{ms as default};
